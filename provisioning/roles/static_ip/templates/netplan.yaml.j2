network:
  version: 2
  ethernets:
{% if interfaces is defined %}
{% for iface in interfaces %}
    {{ iface.name }}:
      dhcp4: false
      addresses:
        - "{{ iface.ip }}"
{% if iface.dns_servers is defined and iface.dns_servers|length > 0 %}
      nameservers:
        addresses: {{ iface.dns_servers }}
{% endif %}
{% endfor %}
{% else %}
    {{ interface_name }}:
      dhcp4: false
      addresses:
        - "{{ static_ip }}"
      nameservers:
        addresses: {{ dns_servers }}
{% endif %}
